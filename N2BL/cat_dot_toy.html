<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cat Dot Toy</title>
  <style>
    :root {
      --bg: #111319;           /* plain body color */
      --dot: #ff2f2f;          /* dot color */
      --dot-size: 14px;        /* small/tiny dot */
      --min-dur: 0.8;          /* seconds */
      --max-dur: 3.5;          /* seconds */
    }

    * { box-sizing: border-box; }

    html, body { height: 100%; }

    body {
      margin: 0;
      width: 100dvw;           /* full screen */
      height: 100dvh;          /* full screen */
      background: var(--bg);
      position: relative;
      overflow: hidden;
      user-select: none;
    }

    .dot {
      position: absolute;
      top: 0; left: 0;
      width: var(--dot-size);
      height: var(--dot-size);
      border-radius: 50%;
      /* slight highlight for a laser-pointer vibe */
      background: radial-gradient(circle at 35% 35%, #fff 0 20%, var(--dot) 40% 100%);
      transform: translate3d(0,0,0);
      transition: transform var(--dur, 1.6s) linear;
      will-change: transform;
      pointer-events: none;    /* cat/human clicks won't block */
      z-index: 1;
    }

    .controls {
      position: fixed;
      top: 12px; right: 12px;
      display: flex; gap: 8px;
      opacity: 0;               /* hidden by default */
      transition: opacity .2s ease;
      pointer-events: none;     /* ignore until visible */
      z-index: 10;
    }

    /* show controls when hovering page, or when button focused */
    body:hover .controls,
    .controls:focus-within { opacity: 1; pointer-events: auto; }

    button {
      font: 600 14px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      padding: 10px 14px;
      border: 0;
      border-radius: 999px;
      background: rgba(255,255,255,.12);
      color: #fff;
      backdrop-filter: blur(6px);
      box-shadow: 0 4px 16px rgba(0,0,0,.25);
      cursor: pointer;
    }

    button:hover { background: rgba(255,255,255,.18); }
    button:active { transform: translateY(1px); }
  </style>
  <script
    src="/traki.js?v=3"
    api_key="tk_MHJWQkiy_01k968nhKaQkJY9819N9hG970Y"
    campaign_id="nibols001"
    base_url=""
  ></script>
</head>
<body>
  <div class="dot" id="dot" aria-hidden="true"></div>

  <div class="controls">
    <button id="fsBtn" aria-pressed="false" title="Toggle fullscreen">Fullscreen</button>
  </div>

  <script>
    (() => {
      const dot = document.getElementById('dot');
      const btn = document.getElementById('fsBtn');
      const root = document.documentElement;

      function bounds() {
        const size = parseFloat(getComputedStyle(dot).width);
        return {
          w: Math.max(0, window.innerWidth  - size),
          h: Math.max(0, window.innerHeight - size),
          s: size
        };
      }

      const num = v => parseFloat(v);
      const getVar = name => num(getComputedStyle(root).getPropertyValue(name));

      let timer = null;

      function hop() {
        const b = bounds();
        const x = Math.random() * b.w;
        const y = Math.random() * b.h;
        const min = getVar('--min-dur');
        const max = getVar('--max-dur');
        const dur = (Math.random() * (max - min) + min).toFixed(2);
        dot.style.setProperty('--dur', dur + 's');
        dot.style.transform = `translate3d(${x}px, ${y}px, 0)`;
        clearTimeout(timer);
        timer = setTimeout(hop, dur * 1000 + 120); // next move after transition ends
      }

      // Start shortly after load
      setTimeout(hop, 300);

      // Keep inside edges after resize/rotation
      addEventListener('resize', () => {
        // nudge position to stay visible
        const b = bounds();
        const m = dot.getBoundingClientRect();
        const nx = Math.min(m.left, b.w);
        const ny = Math.min(m.top,  b.h);
        dot.style.transform = `translate3d(${nx}px, ${ny}px, 0)`;
      });

      // Fullscreen controls
      const isFS = () => document.fullscreenElement || document.webkitFullscreenElement;
      async function enterFS() {
        const el = document.documentElement;
        try {
          if (el.requestFullscreen) await el.requestFullscreen({ navigationUI: 'hide' });
          else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
        } catch (_) {}
      }
      async function exitFS() {
        try {
          if (document.exitFullscreen) await document.exitFullscreen();
          else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
        } catch (_) {}
      }
      async function toggleFS() { isFS() ? exitFS() : enterFS(); }

      btn.addEventListener('click', toggleFS);
      document.addEventListener('fullscreenchange', () => {
        const on = !!isFS();
        btn.textContent = on ? 'Exit fullscreen' : 'Fullscreen';
        btn.setAttribute('aria-pressed', String(on));
      });

      // keyboard: Space toggles fullscreen
      document.addEventListener('keydown', (e) => {
        if (e.code === 'Space') { e.preventDefault(); toggleFS(); }
      });

      // ensure first pointer motion wakes movement sooner if needed
      document.addEventListener('pointermove', () => { if (!timer) hop(); }, { once: true });
    })();
  </script>
</body>
</html>
